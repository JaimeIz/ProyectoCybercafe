# This file is to be sourced from the setup script

## Templates for samba configurations

SMBCONF="
# Generated by entrypoint.sh. Add customizations under /etc/samba/conf.d.
#  DO NOT EDIT THIS FILE.
[global]
	netbios name = $NETBIOS_NAME
	realm = $REALM
	server role = active directory domain controller
	server string = $SERVER_STRING
	server services = -dns
	workgroup = $WORKGROUP

	add machine script = /usr/sbin/adduser -D -H -G users -s /bin/false %u
	bind interfaces only = $BIND_INTERFACES_ONLY
	interfaces = $INTERFACES
	domain logons = $DOMAIN_LOGONS
	domain master = $DOMAIN_MASTER
	log level = $LOG_LEVEL
	winbind refresh tickets = Yes
	winbind use default domain = $WINBIND_USE_DEFAULT_DOMAIN
	${ALLOW_LDAP_INSECURE:+ldap server require strong auth = no}

	tls enabled  = yes
	tls keyfile  = /certs/server.key
	tls certfile = /certs/server.cer
	tls cafile   = /tls/ca.crt
"

NETLOGON="
[netlogon]
	path = /var/lib/samba/sysvol/$DOMAIN/scripts
	read only = No
"

SYSVOL="
[sysvol]
	path = /var/lib/samba/sysvol
	read only = No
"


## Template for the krb config file (/etc/krb5.conf)

KRB5CONF="
[libdefaults]
	default_realm = $REALM
	dns_lookup_realm = false
	dns_lookup_kdc = true

[realms]
	$REALM = {
		kdc = $HOSTNAME:88
		admin_server = $HOSTNAME:749
		kpasswd_server = $HOSTNAME
		default_domain = $DOMAIN
	}

[domain_realm]
	.$DOMAIN = $NETBIOS_NAME.$REALM
	$DOMAIN = $NETBIOS_NAME.$REALM
	$REALM = $NETBIOS_NAME.$REALM
	$WORKGROUP = $REALM
"

